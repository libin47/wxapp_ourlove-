(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{73666:function(e,a,t){Promise.resolve().then(t.bind(t,10679))},10679:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var s=t(57437),l=t(57296),n=t.n(l),i=t(2265),r=t(48836),o=t(74971),d=t(23126),c=t(24137),u=t(28116),x=t(35895),h=t(89663),f=t(92432),g=t(29714),j=t(86992),m=t(13565),p=t(38302),N=t(28683),y=t(98790),v=t(22649);function Z(e){let{card:a}=e,[t,l]=(0,i.useState)(a),[r,Z]=(0,i.useState)(-1),[w,_]=(0,i.useState)(-1),[C,k]=(0,i.useState)(),b=["力量","体质","敏捷","外貌","意志","体型","教育","智力","幸运"],V=(e,a)=>{"age"===a?t.info.age=+e.target.value:"time"===a?t.info.time=e.target.value:"whereborn"===a?t.info.whereborn=e.target.value:"wherelive"===a?t.info.wherelive=e.target.value:"DB"===a?t.attex.DB=e.target.value:"个人介绍"===a?t.story.个人介绍=e.target.value:"形象描述"===a?t.story.形象描述=e.target.value:"思想信念"===a?t.story.思想信念=e.target.value:"重要之人"===a?t.story.重要之人=e.target.value:"意义非凡之地"===a?t.story.意义非凡之地=e.target.value:"宝贵之物"===a?t.story.宝贵之物=e.target.value:"特质"===a?t.story.特质=e.target.value:"精神状况"===a?t.story.精神状况=e.target.value:"魔法物品与典籍"===a?t.story.魔法物品与典籍=e.target.value:"法术"===a?t.story.法术=e.target.value:"第三类接触"===a?t.story.第三类接触=e.target.value:"生活水平"===a?t.CR.CR=e.target.value:"消费水平"===a?t.CR.消费水平=e.target.value:"现金"===a?t.CR.现金=e.target.value:"资产"===a?t.CR.资产=e.target.value:"随身物品"===a?t.item=e.target.value:"名称"===a?t.weapon[w].名称=e.target.value:"伤害"===a&&(t.weapon[w].伤害=e.target.value)},P=e=>{t.skill[r].subName=e,t.skill[r].showName=t.skill[r].name+":"+t.skill[r].subName},A=(e,a)=>{e&&("work"===a?t.skill[r].workPoint=e:"inter"===a?t.skill[r].interPoint=e:"ensure"===a&&(t.skill[r].ensurePoint=e))},M=(e,a)=>{e&&("HP"===a?t.attex.HP=e:"HP_MAX"===a?t.attex.HP_MAX=e:"MP"===a?t.attex.MP=e:"MP_MAX"===a?t.attex.MP_MAX=e:"SAN"===a?t.attex.SAN=e:"SAN_MAX"===a?t.attex.SAN_MAX=e:"体格"===a?t.attex.体格=e:"MOV"===a?t.attex.MOV=e:"故障率"===a?t.weapon[w].故障率=e:"装弹量"===a?t.weapon[w].装弹量=e:"力量"===a?t.attribute.力量=e:"体型"===a?t.attribute.体型=e:"体质"===a?t.attribute.体质=e:"外貌"===a?t.attribute.外貌=e:"幸运"===a?t.attribute.幸运=e:"意志"===a?t.attribute.意志=e:"敏捷"===a?t.attribute.敏捷=e:"教育"===a?t.attribute.教育=e:"智力"===a&&(t.attribute.智力=e))},B=(e,a)=>{e&&"贯穿"===a&&(t.weapon[w].贯穿=e)},S=()=>{let e={...t};Z(-1),l(e)},T=()=>{let e={...t};_(-1),l(e)},O=()=>{Z(-1)},F=()=>{_(-1)};function X(){let e=[];if(r>=0&&t.skill[r].sub){let s=t.skill[r].subList;if(s)for(var a=0;a<s.length;a++)e.push({value:s[a],label:s[a]})}return r>=0?(0,s.jsxs)(d.Z,{title:t.skill[r].showName+"【"+(t.skill[r].defaultPoint+t.skill[r].workPoint+t.skill[r].interPoint+t.skill[r].ensurePoint).toString()+"】",open:r>=0,onOk:S,onCancel:O,children:[t.skill[r].sub?(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:["技能的详细种类",(0,s.jsx)(c.Z,{defaultValue:t.skill[r].subName,style:{width:"80%"},onChange:e=>P(e),options:e}),(0,s.jsx)(u.Z,{})]}):(0,s.jsx)(s.Fragment,{}),(0,s.jsxs)(x.Z,{wrap:"wrap",gap:"small",justify:"center",children:[(0,s.jsx)(h.Z,{className:n().skillinput,readOnly:!0,addonBefore:"默认:",defaultValue:t.skill[r].defaultPoint}),t.skill[r].levelup?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"职业加点:",defaultValue:t.skill[r].workPoint,onChange:e=>A(e,"work")}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"兴趣加点:",defaultValue:t.skill[r].interPoint,onChange:e=>A(e,"inter")})]}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"成长:",defaultValue:t.skill[r].ensurePoint,onChange:e=>A(e,"ensure")})]})]}):(0,s.jsx)(s.Fragment,{})}function D(){t.weapon.push({名称:"武器名称",伤害:"1d3",射程:"10",故障率:100,次数:1,装弹量:-1,贯穿:!1}),l(t),_(t.weapon.length-1)}function H(){var e=w;return -2==w&&(t.weapon.push({名称:"weapon",伤害:"1d3",射程:"10",故障率:100,次数:1,装弹量:-1,贯穿:!1}),l(t),_(t.weapon.length-1),e=t.weapon.length-1),e>=0?(0,s.jsxs)(d.Z,{title:t.weapon[e]["名称"],open:e>=0,onOk:T,onCancel:F,children:[(0,s.jsx)(j.Z,{checkedChildren:"贯穿",unCheckedChildren:"非贯穿",defaultChecked:t.weapon[e].贯穿,onChange:e=>B(e,"贯穿")}),(0,s.jsxs)(x.Z,{wrap:"wrap",gap:"small",justify:"center",children:[(0,s.jsx)(g.Z,{className:n().skillinput,prefix:"武器名称:",defaultValue:t.weapon[e]["名称"],onChange:e=>V(e,"名称")}),(0,s.jsx)(g.Z,{className:n().skillinput,prefix:"伤害:",defaultValue:t.weapon[e].伤害,onChange:e=>V(e,"伤害")}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"故障率:",defaultValue:t.weapon[e].故障率,onChange:e=>M(e,"故障率")}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"装弹量:",defaultValue:t.weapon[e].装弹量,onChange:e=>M(e,"装弹量")})]})]}):(0,s.jsx)(s.Fragment,{})}async function R(e){let a=await fetch(v.Y+"/coc_group_update",{method:"POST",headers:{"Content-Type":"text/plain;charset=UTF-8"},body:JSON.stringify({data:e,card_id:e._id})});(await a.json()).ok&&alert("已更新")}let E=[{key:"1",label:"属性",children:(0,s.jsx)(function(){return(0,s.jsxs)("div",{className:n().attinfo,children:[(0,s.jsxs)("div",{className:n().attbase,children:[(0,s.jsx)(h.Z,{addonBefore:"HP:",defaultValue:t.attex.HP,onChange:e=>M(e,"HP")}),(0,s.jsx)(h.Z,{addonBefore:"最大HP:",defaultValue:t.attex.HP_MAX,onChange:e=>M(e,"HP_MAX")})]}),(0,s.jsx)(f.Z,{percent:t.attex.HP/t.attex.HP_MAX*100,showInfo:!1}),(0,s.jsxs)("div",{className:n().attbase,children:[(0,s.jsx)(h.Z,{addonBefore:"MP:",defaultValue:t.attex.MP,onChange:e=>M(e,"MP")}),(0,s.jsx)(h.Z,{addonBefore:"最大MP:",defaultValue:t.attex.MP_MAX,onChange:e=>M(e,"MP_MAX")})]}),(0,s.jsx)(f.Z,{percent:t.attex.MP/t.attex.MP_MAX*100,showInfo:!1}),(0,s.jsxs)("div",{className:n().attbase,children:[(0,s.jsx)(h.Z,{addonBefore:"SAN:",defaultValue:t.attex.SAN,onChange:e=>M(e,"SAN")}),(0,s.jsx)(h.Z,{addonBefore:"最大SAN:",defaultValue:t.attex.SAN_MAX,onChange:e=>M(e,"SAN_MAX")})]}),(0,s.jsx)(f.Z,{percent:t.attex.SAN/t.attex.SAN_MAX*100,showInfo:!1}),(0,s.jsx)(u.Z,{}),(0,s.jsxs)(x.Z,{wrap:"wrap",gap:"small",justify:"center",children:[b.map((e,a)=>(0,s.jsx)(h.Z,{addonBefore:e,defaultValue:t.attribute[e],className:n().attgrid,onChange:a=>M(a,e)},a)),(0,s.jsx)(h.Z,{addonBefore:"体格",defaultValue:t.attex.体格,className:n().attgrid,onChange:e=>M(e,"体格")}),(0,s.jsx)(g.Z,{prefix:"DB:",defaultValue:t.attex.DB,onChange:e=>V(e,"DB"),className:n().attgrid}),(0,s.jsx)(h.Z,{addonBefore:"MOV",defaultValue:t.attex.MOV,className:n().attgrid,onChange:e=>M(e,"MOV")})]})]})},{})},{key:"2",label:"技能",children:(0,s.jsx)(function(){return(0,s.jsxs)("div",{className:n().attinfo,children:[(0,s.jsx)("div",{className:n().atttitle,children:"技能"}),(0,s.jsx)(X,{}),(0,s.jsx)(x.Z,{wrap:"wrap",gap:"small",justify:"center",children:t.skill.map((e,a)=>(0,s.jsxs)("div",{className:n().attgrid3,onClick:()=>Z(a),children:[(0,s.jsx)("div",{children:e.showName}),(0,s.jsx)("div",{children:e.workPoint+e.interPoint+e.ensurePoint+e.defaultPoint})]},a))})]})},{})},{key:"3",label:"背景故事",children:(0,s.jsx)(function(){return(0,s.jsxs)("div",{className:n().attinfo,children:[(0,s.jsx)("div",{className:n().atttitle,children:"背景故事"}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"个人介绍"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:8,defaultValue:t.story.个人介绍,onChange:e=>V(e,"个人介绍")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"形象描述"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.形象描述,onChange:e=>V(e,"形象描述")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"思想信念"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.思想信念,onChange:e=>V(e,"思想信念")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"重要之人"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.重要之人,onChange:e=>V(e,"重要之人")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"意义非凡之地"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.意义非凡之地,onChange:e=>V(e,"意义非凡之地")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"宝贵之物"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.宝贵之物,onChange:e=>V(e,"宝贵之物")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"特质"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.特质,onChange:e=>V(e,"特质")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"精神状况"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:3,defaultValue:t.story.精神状况,onChange:e=>V(e,"精神状况")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"魔法物品与典籍"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.魔法物品与典籍,onChange:e=>V(e,"魔法物品与典籍")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"法术"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:3,defaultValue:t.story.法术,onChange:e=>V(e,"法术")})]}),(0,s.jsxs)("div",{className:n().storymain,children:[(0,s.jsx)("div",{className:n().storytitle,children:"第三类接触"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:2,defaultValue:t.story.第三类接触,onChange:e=>V(e,"第三类接触")})]})]})},{})},{key:"4",label:"经济情况",children:(0,s.jsx)(function(){return(0,s.jsxs)("div",{className:n().attinfo,children:[(0,s.jsx)("div",{className:n().atttitle,children:"资产情况"}),(0,s.jsxs)(x.Z,{wrap:"wrap",gap:"small",children:[(0,s.jsx)(g.Z,{className:n().attgrid3,prefix:"生活水平:",defaultValue:t.CR.CR,onChange:e=>V(e,"生活水平")}),(0,s.jsx)(g.Z,{className:n().attgrid3,prefix:"消费水平:",defaultValue:t.CR.消费水平,onChange:e=>V(e,"消费水平")}),(0,s.jsx)(g.Z,{className:n().attgrid3,prefix:"现金:",defaultValue:t.CR.现金,onChange:e=>V(e,"现金")}),(0,s.jsx)(g.Z,{className:n().attgrid3,prefix:"资产:",defaultValue:t.CR.资产,onChange:e=>V(e,"资产")})]})]})},{})},{key:"5",label:"随身物品",children:(0,s.jsx)(function(){return(0,s.jsxs)("div",{className:n().attinfo,children:[(0,s.jsx)("div",{className:n().atttitle,children:"随身物品"}),(0,s.jsx)(g.Z.TextArea,{className:n().storytext,rows:8,defaultValue:t.item,onChange:e=>V(e,"随身物品")})]})},{})},{key:"6",label:"武器",children:(0,s.jsx)(function(){return(0,s.jsxs)("div",{className:n().attinfo,children:[(0,s.jsx)("div",{className:n().atttitle,children:"武器"}),(0,s.jsx)(H,{}),(0,s.jsx)(x.Z,{wrap:"wrap",gap:"small",justify:"center",children:t.weapon.map((e,a)=>(0,s.jsxs)("div",{className:n().attgridw,children:[(0,s.jsx)("div",{onClick:()=>{_(a)},children:e["名称"]}),e["贯穿"]?(0,s.jsx)("div",{children:"贯穿√"}):(0,s.jsx)("div",{children:"贯穿\xd7"}),(0,s.jsxs)("div",{children:["⚡",e["故障率"]]}),(0,s.jsxs)("div",{children:["\uD83D\uDD2B",e["装弹量"]]}),(0,s.jsxs)("div",{children:["♥",e["伤害"]]}),(0,s.jsx)(m.ZP,{danger:!0,onClick:()=>(function(e){let a={...t};a.weapon.splice(e,1),l(a)})(a),children:"删除"})]},a))}),(0,s.jsx)(m.ZP,{onClick:D,children:"添加"})]})},{})}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:n().baseinfo,children:[(0,s.jsxs)("div",{className:n().name,children:[t.name," ","男"===t.info.sex?"♂":"♀"]}),(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(N.Z,{span:12,className:n().basegrid,children:(0,s.jsx)(g.Z,{prefix:"职业:",defaultValue:t.职业,onChange:e=>{let a={...t};a.职业=e.target.value,l(a)}})}),(0,s.jsx)(N.Z,{span:12,className:n().basegrid,children:(0,s.jsx)(g.Z,{prefix:"年龄:",defaultValue:t.info.age,onChange:e=>V(e,"age")})})]}),(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(N.Z,{span:12,className:n().basegrid,children:(0,s.jsx)(g.Z,{prefix:"年代:",defaultValue:t.info.time,onChange:e=>V(e,"time")})}),(0,s.jsx)(N.Z,{span:12,className:n().basegrid,children:(0,s.jsx)(g.Z,{prefix:"出生地:",defaultValue:t.info.whereborn,onChange:e=>V(e,"whereborn")})})]}),(0,s.jsx)(p.Z,{children:(0,s.jsx)(N.Z,{span:12,className:n().basegrid,children:(0,s.jsx)(g.Z,{prefix:"居住地:",defaultValue:t.info.wherelive,onChange:e=>V(e,"wherelive")})})}),t.hero&&t.hero>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(N.Z,{span:12,className:n().basegrid,children:(0,s.jsx)(g.Z,{readOnly:!0,prefix:"英雄级别:",defaultValue:t.heroinfo.name+"*"+t.hero})}),(0,s.jsx)(N.Z,{span:12,className:n().basegrid,children:(0,s.jsx)(g.Z,{readOnly:!0,prefix:"天赋:",defaultValue:t.heroinfo.skill.join("，")})})]}),t.heroinfo.skill.map(e=>(0,s.jsx)(p.Z,{children:(0,s.jsxs)(N.Z,{span:24,className:n().basegrid,children:["\uD83E\uDDB8【",e,"】",o.A8[e]]})},e))]}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)(m.ZP,{block:!0,type:"primary",onClick:function(){let e={...t};l(e),console.log(e),R(e)},children:"更新"})]}),(0,s.jsx)(y.Z,{items:E,defaultActiveKey:["1"],children:";"})]})}function w(){let[e,a]=(0,i.useState)(),[t,l]=(0,i.useState)(""),[o,c]=(0,i.useState)(!1),[u,f]=(0,i.useState)(!1);async function g(e){let t=await fetch(v.Y+"/coc_group_get_all",{method:"POST",headers:{"Content-Type":"text/plain;charset=UTF-8"},body:JSON.stringify({group:e})});var s=(await t.json()).data;s&&a(s)}async function j(e){let a=await fetch(v.Y+"/coc_group_config",{method:"POST",headers:{"Content-Type":"text/plain;charset=UTF-8"},body:JSON.stringify({group:e._id,config:e.config})});(await a.json()).ok&&alert("已更新")}(0,i.useEffect)(()=>{let e=window.location.search.split("?")[1];var a=e?e.split("&"):[],t={};for(let e=0;e<a.length;e++){let s=a[e].split("=");t[s[0]]=s[1]}let s=t.group;l(s),g(s)},[]);let p=(a,t)=>{e&&(console.log(a),"point"===t?e.config.point=a:"dicetime"===t?e.config.dicetime=a:"succnum"===t?e.config.succnum=a:"failnum"===t?e.config.failnum=a:"hero"===t&&(e.config.hero=a),console.log(e.config))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:n().bg}),e?(0,s.jsx)(d.Z,{title:"群规设置",open:u,onOk:()=>{a(e),f(!1),j(e)},onCancel:()=>{f(!1)},children:(0,s.jsxs)(x.Z,{wrap:"wrap",gap:"small",justify:"center",children:[(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"角色类型:",defaultValue:e.config.hero?e.config.hero:"0",onChange:e=>p(e,"hero")}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"属性购点总值:",defaultValue:e.config.point,onChange:e=>p(e,"point")}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"属性随机次数:",defaultValue:e.config.dicetime,onChange:e=>p(e,"dicetime")}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"大成功:",defaultValue:e.config.succnum?e.config.succnum:"默认",onChange:e=>p(e,"succnum")}),(0,s.jsx)(h.Z,{className:n().skillinput,addonBefore:"大失败:",defaultValue:e.config.failnum?e.config.failnum:"默认",onChange:e=>p(e,"failnum")})]})}):(0,s.jsx)(s.Fragment,{}),e?o?(0,s.jsx)(r.default,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("head",{children:[" ",(0,s.jsx)("title",{children:"KP看板"})," "]}),(0,s.jsxs)("div",{className:n().maintitle,children:["KP看板",(0,s.jsx)(m.ZP,{onClick:()=>c(!0),children:"模板卡管理"}),(0,s.jsx)(m.ZP,{onClick:()=>f(!0),children:"群规管理"})]}),(0,s.jsx)(x.Z,{wrap:"wrap",gap:"small",justify:"center",children:Object.keys(e.card).map((a,t)=>(0,s.jsx)("div",{style:{width:"32%"},children:(0,s.jsx)(Z,{card:e.card[a]})},t))})]}):(0,s.jsx)(s.Fragment,{})]})}},57296:function(e){e.exports={bg:"page_bg__3nsoa",baseinfo:"page_baseinfo__NFBC3",name:"page_name__Z35LR",basegrid:"page_basegrid__nWp5U",attinfo:"page_attinfo__c3x3q",atttitle:"page_atttitle__cvOxh",attbase:"page_attbase__xgS2S",attprogress:"page_attprogress__zpt25",attgrid:"page_attgrid__fCrmo",skillinput:"page_skillinput__EJ1Mj",attgrid3:"page_attgrid3__9hqyV",attgrid1:"page_attgrid1__wd7ha",attgridw:"page_attgridw__TvG4C",storytitle:"page_storytitle__NBL_2",storytext:"page_storytext__8edXQ",maintitle:"page_maintitle__fEtv1"}}},function(e){e.O(0,[740,881,715,668,11,269,836,971,69,744],function(){return e(e.s=73666)}),_N_E=e.O()}]);